import{c as Q,a as r,f as _,s as x,t as Pe}from"../chunks/DLNOMP84.js";import{i as We}from"../chunks/C5ne2wUq.js";import{p as je,o as Fe,l as He,k as Ue,z as V,r as ze,s as M,m as j,g as e,D as Be,x as a,$ as Je,u as s,w as t,q as h,v as u,G as Ke}from"../chunks/D2mf_MPo.js";import{i as m}from"../chunks/BDyHfgtg.js";import{e as X,i as Z,s as R}from"../chunks/CoSwtozg.js";import{h as Ye}from"../chunks/BNZG-Io9.js";import{s as Ge,a as Qe}from"../chunks/DlPtdyWE.js";import{p as Ve}from"../chunks/BP5smSF2.js";import{r as Xe,t as Ze,u as ea}from"../chunks/MscGuMyR.js";var aa=_('<div class="loading svelte-13eo3pq">Laster...</div>'),ta=_('<div class="error svelte-13eo3pq"> </div>'),sa=_('<p class="years svelte-13eo3pq"> </p>'),ra=_('<p class="bio svelte-13eo3pq"> </p>'),oa=_('<a target="_blank" rel="noopener" class="external-link svelte-13eo3pq">Sceneweb</a>'),ia=_('<a target="_blank" rel="noopener" class="external-link svelte-13eo3pq">Wikipedia</a>'),va=_('<img loading="lazy" class="svelte-13eo3pq"/>'),la=_('<div class="play-placeholder svelte-13eo3pq"><span>ðŸŽ­</span></div>'),na=_('<span class="play-year svelte-13eo3pq"> </span>'),pa=_('<span class="play-count svelte-13eo3pq"> </span>'),_a=_('<a class="play-card svelte-13eo3pq"><div class="play-image svelte-13eo3pq"><!></div> <div class="play-info svelte-13eo3pq"><h3 class="svelte-13eo3pq"> </h3> <!> <!></div></a>'),da=_('<section class="plays-written svelte-13eo3pq"><h2 class="svelte-13eo3pq"> </h2> <div class="plays-grid svelte-13eo3pq"></div></section>'),ca=_('<img loading="lazy" class="svelte-13eo3pq"/>'),fa=_('<div class="about-placeholder svelte-13eo3pq"><span>ðŸ“º</span></div>'),ua=_('<span class="about-type svelte-13eo3pq">Serie<!></span>'),ha=_('<span class="about-duration"> </span>'),ma=_('<a target="_blank" rel="noopener" class="about-card svelte-13eo3pq"><div class="about-image svelte-13eo3pq"><!></div> <div class="about-info svelte-13eo3pq"><h3 class="svelte-13eo3pq"> </h3> <div class="about-meta svelte-13eo3pq"><!> <!></div></div> <span class="external-arrow svelte-13eo3pq">â†—</span></a>'),ga=_('<section class="nrk-about svelte-13eo3pq"><h2 class="svelte-13eo3pq">I NRK-arkivet</h2> <div class="about-programs-grid svelte-13eo3pq"></div></section>'),qa=_('<img loading="lazy" class="svelte-13eo3pq"/>'),ba=_('<div class="play-placeholder svelte-13eo3pq"><span>ðŸŽ­</span></div>'),ka=_('<span class="play-year svelte-13eo3pq"> </span>'),xa=_('<span class="play-count svelte-13eo3pq"> </span>'),ya=_('<span class="playwright svelte-13eo3pq"> </span>'),wa=_('<a class="play-card svelte-13eo3pq"><div class="play-image svelte-13eo3pq"><!></div> <div class="play-info svelte-13eo3pq"><h3 class="svelte-13eo3pq"> </h3> <!> <!> <!></div></a>'),Ea=_('<section class="role-section svelte-13eo3pq"><h2 class="svelte-13eo3pq"> </h2> <div class="plays-grid svelte-13eo3pq"></div></section>'),Oa=_('<article class="person-detail svelte-13eo3pq"><a href="/" class="back-link svelte-13eo3pq">&larr; Tilbake til oversikt</a> <header class="person-header svelte-13eo3pq"><div class="header-content svelte-13eo3pq"><div class="header-text svelte-13eo3pq"><h1 class="svelte-13eo3pq"> </h1> <!> <!> <div class="external-links svelte-13eo3pq"><!> <!></div></div></div></header> <!> <!> <!></article>');function La(ge,qe){je(qe,!1);const ve=()=>Qe(Ve,"$page",be),[be,ke]=Ge(),F=j();let l=j(null),ee=j([]),C=j([]),Y=j([]),ae=j(!0),G=j(null);Fe(()=>{xe()});function xe(){try{if(M(l,Xe(e(F))),e(l)){const n=Ze(),k=n.prepare(`
					SELECT p.id, p.title, p.year_written,
						(SELECT COUNT(*) FROM episodes e WHERE e.play_id = p.id) as episode_count,
						(SELECT e.image_url FROM episodes e WHERE e.play_id = p.id LIMIT 1) as image_url
					FROM plays p
					WHERE p.playwright_id = ?
					ORDER BY p.year_written, p.title
				`);for(k.bind([e(F)]),M(C,[]);k.step();)e(C).push(k.getAsObject());k.free();const w=n.prepare(`
					SELECT DISTINCT role FROM episode_persons
					WHERE person_id = ? AND role != 'playwright'
				`);w.bind([e(F)]);const H=[];for(;w.step();)H.push(w.getAsObject().role);w.free(),M(ee,[]);for(const D of H){const E=n.prepare(`
						SELECT
							p.id as play_id,
							p.title,
							MIN(e.image_url) as image_url,
							COUNT(*) as episode_count,
							MIN(e.year) as year,
							pw.name as playwright_name
						FROM episodes e
						JOIN episode_persons ep ON e.prf_id = ep.episode_id
						JOIN plays p ON e.play_id = p.id
						LEFT JOIN persons pw ON p.playwright_id = pw.id
						WHERE ep.person_id = ? AND ep.role = ?
						GROUP BY p.id
						ORDER BY year DESC
					`);E.bind([e(F),D]);const $=[];for(;E.step();)$.push(E.getAsObject());E.free(),$.length>0&&e(ee).push({role:D,plays:$})}M(Y,ea(e(F)))}else M(G,"Person ikke funnet");M(ae,!1)}catch(n){M(G,n instanceof Error?n.message:"Ukjent feil"),M(ae,!1)}}function ye(n){return{director:"Regissert",actor:"Spilt i",playwright:"Manus",composer:"Komponert",producer:"Produsert",other:"Annet"}[n]||n}function we(n){if(!n)return"";const k=Math.floor(n/3600),w=Math.floor(n%3600/60);return k>0?`${k}t ${w}m`:`${w} min`}function le(n,k=320){return n?n.includes("gfx.nrk.no")?n.replace(/\/\d+$/,`/${k}`):n:"/placeholder.jpg"}He(()=>ve(),()=>{M(F,parseInt(ve().params.id||"0"))}),Ue(),We();var ne=Q();Ye("13eo3pq",n=>{var k=Q(),w=V(k);{var H=D=>{Be(()=>{Je.title=`${e(l),a(()=>e(l).name)??""} - Kulturperler`})};m(w,D=>{e(l)&&D(H)})}r(n,k)});var Ee=V(ne);{var Oe=n=>{var k=aa();r(n,k)},Re=n=>{var k=Q(),w=V(k);{var H=E=>{var $=ta(),te=s($,!0);t($),h(()=>x(te,e(G))),r(E,$)},D=E=>{var $=Q(),te=V($);{var $e=se=>{var re=Oa(),oe=u(s(re),2),pe=s(oe),_e=s(pe),ie=s(_e),Ne=s(ie,!0);t(ie);var de=u(ie,2);{var Se=d=>{var v=sa(),y=s(v);t(v),h(()=>x(y,`${e(l),a(()=>e(l).birth_year||"?")??""}â€“${e(l),a(()=>e(l).death_year||"")??""}`)),r(d,v)};m(de,d=>{e(l),a(()=>e(l).birth_year||e(l).death_year)&&d(Se)})}var ce=u(de,2);{var Ie=d=>{var v=ra(),y=s(v,!0);t(v),h(()=>x(y,(e(l),a(()=>e(l).bio)))),r(d,v)};m(ce,d=>{e(l),a(()=>e(l).bio)&&d(Ie)})}var fe=u(ce,2),ue=s(fe);{var Me=d=>{var v=oa();h(()=>R(v,"href",(e(l),a(()=>e(l).sceneweb_url)))),r(d,v)};m(ue,d=>{e(l),a(()=>e(l).sceneweb_url)&&d(Me)})}var Te=u(ue,2);{var Ce=d=>{var v=ia();h(()=>R(v,"href",(e(l),a(()=>e(l).wikipedia_url)))),r(d,v)};m(Te,d=>{e(l),a(()=>e(l).wikipedia_url)&&d(Ce)})}t(fe),t(_e),t(pe),t(oe);var he=u(oe,2);{var De=d=>{var v=da(),y=s(v),L=s(y);t(y);var c=u(y,2);X(c,5,()=>e(C),Z,(S,p)=>{var i=_a(),N=s(i),A=s(N);{var U=o=>{var b=va();h(O=>{R(b,"src",O),R(b,"alt",(e(p),a(()=>e(p).title)))},[()=>(e(p),a(()=>le(e(p).image_url)))]),r(o,b)},P=o=>{var b=la();r(o,b)};m(A,o=>{e(p),a(()=>e(p).image_url)?o(U):o(P,!1)})}t(N);var z=u(N,2),I=s(z),T=s(I,!0);t(I);var B=u(I,2);{var J=o=>{var b=na(),O=s(b,!0);t(b),h(()=>x(O,(e(p),a(()=>e(p).year_written)))),r(o,b)};m(B,o=>{e(p),a(()=>e(p).year_written)&&o(J)})}var K=u(B,2);{var q=o=>{var b=pa(),O=s(b);t(b),h(()=>x(O,`${e(p),a(()=>e(p).episode_count)??""} opptak`)),r(o,b)};m(K,o=>{e(p),a(()=>e(p).episode_count>0)&&o(q)})}t(z),t(i),h(()=>{R(i,"href",`/play/${e(p),a(()=>e(p).id)??""}`),x(T,(e(p),a(()=>e(p).title)))}),r(S,i)}),t(c),t(v),h(()=>x(L,`Stykker tilgjengelig (${e(C),a(()=>e(C).length)??""})`)),r(d,v)};m(he,d=>{e(C),a(()=>e(C).length>0)&&d(De)})}var me=u(he,2);{var Le=d=>{var v=ga(),y=u(s(v),2);X(y,5,()=>e(Y),Z,(L,c)=>{var S=ma(),p=s(S),i=s(p);{var N=q=>{var o=ca();h(()=>{R(o,"src",(e(c),a(()=>e(c).image_url))),R(o,"alt",(e(c),a(()=>e(c).title)))}),r(q,o)},A=q=>{var o=fa();r(q,o)};m(i,q=>{e(c),a(()=>e(c).image_url)?q(N):q(A,!1)})}t(p);var U=u(p,2),P=s(U),z=s(P,!0);t(P);var I=u(P,2),T=s(I);{var B=q=>{var o=ua(),b=u(s(o));{var O=f=>{var g=Pe();h(()=>x(g,`Â· ${e(c),a(()=>e(c).episode_count)??""} ep`)),r(f,g)};m(b,f=>{e(c),a(()=>e(c).episode_count)&&f(O)})}t(o),r(q,o)};m(T,q=>{e(c),a(()=>e(c).program_type==="serie")&&q(B)})}var J=u(T,2);{var K=q=>{var o=ha(),b=s(o,!0);t(o),h(O=>x(b,O),[()=>(e(c),a(()=>we(e(c).duration_seconds)))]),r(q,o)};m(J,q=>{e(c),a(()=>e(c).duration_seconds)&&q(K)})}t(I),t(U),Ke(2),t(S),h(()=>{R(S,"href",(e(c),a(()=>e(c).nrk_url))),x(z,(e(c),a(()=>e(c).title)))}),r(L,S)}),t(y),t(v),r(d,v)};m(me,d=>{e(Y),a(()=>e(Y).length>0)&&d(Le)})}var Ae=u(me,2);X(Ae,1,()=>e(ee),Z,(d,v)=>{var y=Ea(),L=s(y),c=s(L);t(L);var S=u(L,2);X(S,5,()=>(e(v),a(()=>e(v).plays)),Z,(p,i)=>{var N=wa(),A=s(N),U=s(A);{var P=f=>{var g=qa();h(W=>{R(g,"src",W),R(g,"alt",(e(i),a(()=>e(i).title)))},[()=>(e(i),a(()=>le(e(i).image_url)))]),r(f,g)},z=f=>{var g=ba();r(f,g)};m(U,f=>{e(i),a(()=>e(i).image_url)?f(P):f(z,!1)})}t(A);var I=u(A,2),T=s(I),B=s(T,!0);t(T);var J=u(T,2);{var K=f=>{var g=ka(),W=s(g,!0);t(g),h(()=>x(W,(e(i),a(()=>e(i).year)))),r(f,g)};m(J,f=>{e(i),a(()=>e(i).year)&&f(K)})}var q=u(J,2);{var o=f=>{var g=xa(),W=s(g);t(g),h(()=>x(W,`${e(i),a(()=>e(i).episode_count)??""} deler`)),r(f,g)};m(q,f=>{e(i),a(()=>e(i).episode_count>1)&&f(o)})}var b=u(q,2);{var O=f=>{var g=ya(),W=s(g,!0);t(g),h(()=>x(W,(e(i),a(()=>e(i).playwright_name)))),r(f,g)};m(b,f=>{e(i),a(()=>e(i).playwright_name)&&f(O)})}t(I),t(N),h(()=>{R(N,"href",`/play/${e(i),a(()=>e(i).play_id)??""}`),x(B,(e(i),a(()=>e(i).title)))}),r(p,N)}),t(S),t(y),h(p=>x(c,`${p??""} (${e(v),a(()=>e(v).plays.length)??""})`),[()=>(e(v),a(()=>ye(e(v).role)))]),r(d,y)}),t(re),h(()=>x(Ne,(e(l),a(()=>e(l).name)))),r(se,re)};m(te,se=>{e(l)&&se($e)},!0)}r(E,$)};m(w,E=>{e(G)?E(H):E(D,!1)},!0)}r(n,k)};m(Ee,n=>{e(ae)?n(Oe):n(Re,!1)})}r(ge,ne),ze(),ke()}export{La as component};
